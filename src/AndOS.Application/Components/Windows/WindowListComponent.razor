@inject IProcessManager ProcessManager
@inject ILogger<WindowListComponent> Logger
@implements IDisposable
@namespace AndOS.Application.Components.Windows

@foreach (var process in ProcessManager.Processes.Where(x => x.Window is not null))
{
    <WindowItemComponent Content="process" @key=process />
}

@code {
    protected override void OnInitialized()
    {
        ProcessManager.OnWindowOpen += Refresh;
        ProcessManager.OnWindowClose += Refresh;
        ProcessManager.OnWindowFocus += Refresh;
    }

    public void Dispose()
    {
        ProcessManager.OnWindowOpen -= Refresh;
        ProcessManager.OnWindowClose -= Refresh;
        ProcessManager.OnWindowFocus -= Refresh;
    }

    Task Refresh(Window window)
    {
        StateHasChanged();
        return Task.CompletedTask;
    }
}